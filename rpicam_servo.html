<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project Title | Jasper Lee</title>
  <link rel="stylesheet" href="style.css?v=20240621" />
  <style>
    .project-detail .project-copy .detail-intro {
      color: rgba(217, 228, 255, 0.92);
      margin-bottom: 1.5rem;
    }

    .project-detail .project-copy .detail-grid {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: clamp(1rem, 2.5vw, 1.75rem);
      margin-bottom: clamp(1.75rem, 3vw, 2.5rem);
      width: min(100%, 90vw);
      margin-inline: auto;
    }

    .project-detail .project-copy .detail-card {
      background: rgba(10, 22, 58, 0.55);
      border: 1px solid rgba(80, 124, 210, 0.4);
      border-radius: 16px;
      box-shadow: 0 22px 55px rgba(3, 9, 28, 0.55);
      padding: clamp(1.1rem, 2.4vw, 1.6rem);
      min-width: 0;
      width: min(100%, 90vw);
      box-sizing: border-box;
      margin-inline: auto;
    }

    .project-detail .project-copy .detail-card h4 {
      margin-top: 0;
      margin-bottom: 0.85rem;
      font-weight: 500;
      color: #f2f6ff;
    }

    .project-detail .project-copy .detail-card ul {
      margin: 0;
      padding-left: 1.1rem;
      line-height: 1.65;
      word-break: break-word;
      overflow-wrap: anywhere;
    }

    .project-detail .project-copy .detail-card ul li + li {
      margin-top: 0.35rem;
    }

    .project-detail .project-copy .code-card {
      margin-top: clamp(1.5rem, 3vw, 2.5rem);
    }

    .project-detail .project-copy .code-card p {
      margin-bottom: 1rem;
      color: rgba(217, 228, 255, 0.85);
    }

    .project-detail .project-copy .code-card pre {
      background: rgba(8, 18, 46, 0.75);
      border: 1px solid rgba(82, 124, 210, 0.38);
      border-radius: 14px;
      padding: 1.1rem clamp(1.1rem, 2.5vw, 1.75rem);
      margin: 0;
      overflow-x: auto;
      box-shadow: inset 0 0 25px rgba(6, 12, 32, 0.55);
      max-width: 100%;
    }

    .project-detail .project-copy .code-card code {
      display: block;
      font-family: "SFMono-Regular", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.92rem;
      line-height: 1.6;
      color: #f4f8ff;
      white-space: pre-wrap;
      word-break: break-word;
      overflow-wrap: anywhere;
    }

    .project-detail .follow-progress {
      justify-content: center;
    }

    .project-detail .progress-button {
      display: inline-block;
      padding: 0.9rem 1.8rem;
      border-radius: 999px;
      background: linear-gradient(135deg, #6fa8ff, #4a72d9);
      color: #0a122e;
      font-weight: 600;
      text-decoration: none;
      box-shadow: 0 12px 35px rgba(20, 74, 170, 0.35);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .project-detail .progress-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 16px 40px rgba(20, 74, 170, 0.45);
    }

    .project-detail .project-section.reverse .project-copy {
      flex: 1 1 100%;
      width: 100%;
    }

    @media (max-width: 640px) {
      .project-detail .project-copy .detail-card {
        padding: clamp(1rem, 4vw, 1.35rem);
      }

      .project-detail .project-copy .code-card pre {
        padding: clamp(0.85rem, 4vw, 1.25rem);
      }

      .project-detail .project-copy .code-card code {
        font-size: 0.88rem;
      }
    }
  </style>
</head>
<body class="brain-theme project-detail">
  <canvas id="brain-canvas"></canvas>

  <header>
    <div class="nav-left">
      <h1 class="logo">Jasper Lee</h1>
      <nav>
        <a href="index.html#about">About</a>
        <a href="index.html#left-brain" class="active">Left Brain</a>
        <a href="index.html#right-brain">Right Brain</a>
        <a href="index.html#contact">Contact</a>
      </nav>
    </div>
    <!-- <a class="back-link" href="index.html#left-brain">← Back to Left Brain</a> -->
  </header>

  <main class="project-page">
    <section class="project-shell">
      <h2>2-DOF Marker Tracker</h2>
      <p class="project-tagline"> Vision-Guided 2-DOF Marker Tracking applicable to motion sensing robotics.</p>

      <div class="project-section">
        <div class="project-media">
          <img src="rpicam-servo.heic" alt="Prototype of the project" />
        </div>
        <div class="project-copy">
          <h3>Background/Origin</h3>
          <p>
            I decided to learn more about computer vision / object detection and went ahead to work on a simple
            yet deceptively complex marker tracking system. I implemented a real-time visual servoing system that 
            tracks a green colored marker (which I cut out of a KF94 Mask packaging) and drives a two-axis servo 
            mechanism to keep the target centered in 
            the camera frame. To do this I built a low-latency CSI capture pipeline on Jetson using nvarguscamerasrc 
            and OpenCV GStreamer along with per-frame detection using HSV color 
            segmentation, morphological denoising, contour extraction, and 
            centroid estimation via image moments. I then closed the loop with proportional control 
            (pixel error → angle update), deadband jitter suppression, saturation limits, and exponential 
            smoothing for stable motion. Servo commands are generated through a servo driver over I²C with 
            calibrated pulse-width limits and 50 Hz PWM timing.
          </p>
        </div>
       
      </div>

      <div class="project-section reverse">
        <div class="project-copy">
          <h3>Engineering the Solution</h3>
          <p class="detail-intro">
            A Raspberr Pi (Rpi) camera streams video into the Jetson Orin Nano. The code detects a colored marker 
          (a green piece of plastic) in each frame, computes its centroid, and then commands two servos 
          (X and Y axes) to translate/aim so the marker stays centered in the image. This is essentially
          visual servoing: camera feedback → error → actuator commands. Below is my System Architecture:
          </p>

          <div class="detail-grid">
            <div class="detail-card">
              <h4>Hardware :</h4>
              <ul>
                <li>Nvidia Jetson Orin Nano: runs computer vision model + control loops</li>
                <li>Raspberry Pi Cam V2.1: low latency image capture</li>
                <li>Sparkfun Pi Servo pHAT driver over I²C</li>
                <li>2 Servo Motors on channels 0 and 1</li>
              </ul>
            </div>
          </div>

          <div class="detail-grid">
            <div class="detail-card">
              <h4>Software Blocks :</h4>
              <ul>
                <li>Servo Driver initialization + servo PWM</li>
                <li>Camera captures images via GStreamer + nvarguscamerasrc (Rpi Cam path)</li>
                <li>Computer Vision: HSV color thresholding --> morphology --> contour --> centroid</li>
                <li>Control: error --> deadband --> proportional update --> clamp --> smoothing</li>
                <li>Send PWM signals to command servos each frame</li>
              </ul>
            </div>
            <div class="project-copy">
              <h3>In action:</h3>
              <p>
                Here you can see it in action where the servo motors respond to x and y translation.
              </p>
               <iframe
                src="https://www.youtube.com/embed/htoF9Fu_M18"
                title="Project Video"
                frameborder="0"
                allowfullscreen
              ></iframe>
            </div>
          </div>

          

          
      <div class="project-section">
        <div class="project-copy">
          <h3>Camera Pipeline</h3>
          <p>
            Using Nvidia's camera stack, "nvarguscamerasrc" talks to the Rpi Cam;
            then the pipeline converts the camera output into BGR frames that OpenCV 
            can use. I discard old frames to keep latency low, instead of building up delay. 
            This is vital for real-time tracking.
          </p>
        </div>
        <div class="project-copy">
          <h3>Servo Control</h3>
          <p>
            I first set the PWM frequency to 50 Hz (typical servo frequency). Next I convert
            the angle into pulse width using a calibrated range of (700, 2300). After that,
            I convert microseconds to PCA "ticks." This produces a stable servo output that is
            independent of Jetson PWM quirks.
          </p>
        </div>
        <div class="project-copy">
          <h3>Computer Vision techniques</h3>
          <p>
            To start, I converted each frame to HSV then threshold it into my "green" range of lower 
            [40, 80, 80] to upper [85, 255, 255]. This separates "color" or hue from "lighting" or value. 
            This would be more stable than RGB under brightness changes. Next, I applied a simple
            morphological opening that removes small specks and cleans the "green blob" detected by the 
            Rpi Cam. I then find the contour of the object by enclosing the largest contour detected--a 
            heuristic approach that assumes the dominant green object as the target. Similarly, I set
            an area threshold that prevents false detections when tiny green pixels exist inside the image
            captures. Finally, I find the centroid via "moments". 
          </p>
        </div>
        <div class="project-copy">
          <h3>Control Algorithm</h3>
          <p>
            Each frame, I compute the error between the target centroid measured from moments, and
            the image center. I make sure to add a Deadband to supress jitter. Next, I implement 
            P - control (Proportional control) to update the desired servo angles. P-control means 
            the larger the pixel error, the greater the servo correction is. I then run an EMA/1st order
            low-pass filter on the command signal to make the motion smoother and less oscillatory.
          </p>
        </div>
      </div>

   

      <div class="project-section follow-progress">
        <div class="project-copy">
          <a
            class="progress-button"
            href="https://docs.google.com/document/d/1I0BCZIBobzxip4Z7ckE82kM4HeJyuDtMKiybmq5aJBQ/edit?usp=sharing"
            target="_blank"
            rel="noopener noreferrer"
          >
            Click to follow my progress
          </a>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>© 2025 Jasper Lee</p>
  </footer>

  <script>
    (function () {
      const desiredHighlight = 'left';

      function applyHighlight() {
        if (window.setBrainHighlight) {
          window.setBrainHighlight(desiredHighlight);
        } else {
          window.pendingBrainHighlight = desiredHighlight;
        }
      }

      if (document.readyState === 'complete' || document.readyState === 'interactive') {
        applyHighlight();
      } else {
        document.addEventListener('DOMContentLoaded', applyHighlight);
      }
    })();
  </script>
  <script src="brain.js?v=20240621" defer></script>
</body>
</html>
